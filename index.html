<!DOCTYPE html>
<html>
<head>
  <title>Kauri Articles</title>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>

<style>
.center {
text-align: center;
list-style-position: inside;
}

/* body {
  /* background-image: url('https://i.ytimg.com/vi/JPpWNjmlO7w/maxresdefault.jpg'); */
  background-image: url('https://www.cryptoninjas.net/wp-content/uploads/2017/10/local-ethereum-launch-live-trading-eth-ether.png')
} */
</style>
  <h1 style="text-align:center">Subgraph of Kauri</h1>

  <div style="text-align:center" id="all">
    <b>Enter the no of latest articles you want</b>
    <input name="n" placeholder="0">
    <ol class="center">
        <li v-for="d in dt ">
        {{ d }}
        </li>
    </ol>
    <button v-on:click="submitButton">submit</button>
  </div>

  <br/>
  <br/>

  <div style="text-align:center" id="titles">
    <b>Get latest titles and their author</b>
    <input name="m" placeholder="0">
    <ol class="center">
        <li v-for="i in dt1.length">
        <b>Author:</b> {{ dt1[i-1] }}      <b>Title: </b></bTitle:> {{ dt2[i-1] }} 
        <br/>
        </li>
    </ol>
    <button v-on:click="submitButton">submit</button>
  </div>

  <br/>
  <br/>

  <div style="text-align:center" id="author">
    <b>Get titles by specific author</b>
    <input name="o" placeholder="">
    <ol class="center">
        <li v-for="e in titl">
         <i>{{ e }}</i>
        <br/>
        </li>
    </ol>
    <button v-on:click="submitButton">submit</button>
  </div>

  <br/>
  <br/>


  <div style="text-align:center" id="tag">
    <b>Get titles with specific tag on latest articles</b>
    <input name="p" placeholder="">
    <ol class="center">
        <li v-for="f in tagg">
         <i>{{ f }}</i>
        <br/>
        </li>
    </ol>
    <button v-on:click="submitButton">submit</button>
  </div>
  <!-- <div style="text-align:center" id="releaseOr">
    Given trade was released
    <input name="o" placeholder="txHash">
    <p>{{ released }}</p>
    <button v-on:click="submitButton">submit</button>
  </div>

  <br/>
  <br/>

  <div style="text-align:center" id="cancel">
    Who cancelled the given trade
    <input name="p" placeholder="cancelledTradehash">
    <p>{{ cancelled }}</p>
    <button v-on:click="submitButton">submit</button>
  </div> -->

  <script>


    var Content = new Vue({
    el: '#all',
    data: {
        dt: []
    },
    methods: {
        submitButton: function (event) {
          const n = document.querySelector("input[name=n]").value;
          const options = {
            method: "post",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              query: '{ articles(first: ' + n +') { content } }'
            })
          };
          (async() => {
            var res = await fetch(`https://api.thegraph.com/subgraphs/name/nanspro/kauri`, options);
            var data1 = await res.json();
            // console.log(data1)
            var articls = data1["data"]
            var articles = articls["articles"]
            // console.log(articles)
            var data = []
            for (var i=0; i<articles.length; i++){
                var d = articles[i]["content"]
                data.push(d)
            }
            Content.dt = data
          })()
        }
      }
    })

    var Title = new Vue({
    el: '#titles',
    data: {
        dt1: [],
        dt2: []
    },
    methods: {
        submitButton: function (event) {
          const m = document.querySelector("input[name=m]").value;
          const options = {
            method: "post",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              query: '{ articles(first: ' + m +') { author title } }'
            })
          };
          (async() => {
            var res = await fetch(`https://api.thegraph.com/subgraphs/name/nanspro/kauri`, options);
            var data = await res.json();
            console.log(data);
            var articls = data["data"]
            var articles = articls["articles"]
            console.log(articles)
            var data1 = []
            var data2 = []
            for (var i=0; i<articles.length; i++){
                var d = articles[i]["title"]
                var e = articles[i]["author"]
                data1.push(e)
                data2.push(d)
            }
            Title.dt1 = data1
            Title.dt2 = data2
          })()
        }
      }
    })

    var Author = new Vue({
    el: '#author',
    data: {
        titl: []
    },
    methods: {
        submitButton: function(event) {
          const hash = document.querySelector("input[name=o]").value;
          const options = {
            method: "post",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              query: '{ articles(where: {author: ' + '"' + hash + '"' + '}) { title } }'
            })
          };
          (async() => {
            var res = await fetch(`https://api.thegraph.com/subgraphs/name/nanspro/kauri`, options);
            var data = await res.json();
            console.log(data);
            var articls = data["data"]
            var articles = articls["articles"]
            console.log(articles)
            var data1 = []
            for (var i=0; i<articles.length; i++){
                var d = articles[i]["title"]
                data1.push(d)
            }
            Author.titl = data1
            console.log(data1)
          })()
        }
    }
    })


    var Tags = new Vue({
    el: '#tag',
    data: {
        tagg: []
    },
    methods: {
        submitButton: function(event) {
          const hash = document.querySelector("input[name=p]").value;
          console.log(hash)
          const options = {
            method: "post",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              query: '{ articles(first: 10) { tags title } }'
            })
          };
          (async() => {
            var res = await fetch(`https://api.thegraph.com/subgraphs/name/nanspro/kauri`, options);
            var data = await res.json();
            console.log(data);
            var articls = data["data"]
            var articles = articls["articles"]
            console.log(articles)
            var data1 = []
            for (var i=0; i<articles.length; i++){
                var d = articles[i]["tags"]
                for(var j=0; j<d.length; j++){
                  if (d[j] == hash){
                    data1.push(articles[i]["title"])
                    break;
                  } 

                }
            }
            Tags.tagg = data1
            console.log(data1)
          })()
        }
    }
    })
  </script>
</body>
</html>